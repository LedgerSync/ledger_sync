# frozen_string_literal: true

require 'spec_helper'

support :serialization_helpers

RSpec.describe LedgerSync::Serialization::DeserializerAttribute do
  include SerializationHelpers

  let(:attribute) do
    described_class.new(
      block: nil,
      resource_attribute: :asdf,
      type: LedgerSync::Type::Value
    )
  end

  describe '#build_resource_value_from_nested_attributes' do
    it do
      resource = attribute.send(
        :build_resource_value_from_nested_attributes,
        LedgerSync::Ledgers::TestLedger::Customer.new,
        'asdf',
        'subsidiary.ledger_id'.split('.')
      )

      expect(resource.subsidiary.ledger_id).to eq('asdf')
    end
  end
end
